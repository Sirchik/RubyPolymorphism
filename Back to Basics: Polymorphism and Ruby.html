<!DOCTYPE html>
<html class="wf-callunasans-n7-active wf-courierprime-i4-active wf-courierprime-i7-active wf-courierprime-n4-active wf-courierprime-n7-active wf-freighttextpro-i4-active wf-freighttextpro-i7-active wf-freighttextpro-n4-active wf-freighttextpro-n7-active wf-callunasans-i7-active wf-callunasans-n4-active wf-active"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta content="IE=edge" http-equiv="X-UA-Compatible">
<script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/e7b64f6f75" type="text/javascript"></script><script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/nr-632.js"></script><script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/analytics.js" async="" type="text/javascript"></script><script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/analytics_002.js" async="" type="text/javascript"></script><script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"e7b64f6f75","applicationID":"6033300","transactionName":"J1xdTBFdD1pRQUpVFBBaUFQGQUxFXFwS","queueTime":2,"applicationTime":140,"agent":"js-agent.newrelic.com/nr-632.min.js"}</script>
<script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o?o:n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({QJf3ax:[function(e,n){function t(e){function n(n,t,a){e&&e(n,t,a),a||(a={});for(var u=c(n),f=u.length,s=i(a,o,r),p=0;f>p;p++)u[p].apply(s,t);return s}function a(e,n){f[e]=c(e).concat(n)}function c(e){return f[e]||[]}function u(){return t(n)}var f={};return{on:a,emit:n,create:u,listeners:c,_events:f}}function r(){return{}}var o="nr@context",i=e("gos");n.exports=t()},{gos:"7eSDFh"}],ee:[function(e,n){n.exports=e("QJf3ax")},{}],3:[function(e,n){function t(e){return function(){r(e,[(new Date).getTime()].concat(i(arguments)))}}var r=e("handle"),o=e(1),i=e(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(e,n){window.NREUM[n]=t("api-"+n)}),n.exports=window.NREUM},{1:12,2:13,handle:"D5DuLP"}],"7eSDFh":[function(e,n){function t(e,n,t){if(r.call(e,n))return e[n];var o=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return e[n]=o,o}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],gos:[function(e,n){n.exports=e("7eSDFh")},{}],handle:[function(e,n){n.exports=e("D5DuLP")},{}],D5DuLP:[function(e,n){function t(e,n,t){return r.listeners(e).length?r.emit(e,n,t):(o[e]||(o[e]=[]),void o[e].push(n))}var r=e("ee").create(),o={};n.exports=t,t.ee=r,r.q=o},{ee:"QJf3ax"}],id:[function(e,n){n.exports=e("XL7HBI")},{}],XL7HBI:[function(e,n){function t(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:i(e,o,function(){return r++})}var r=1,o="nr@id",i=e("gos");n.exports=t},{gos:"7eSDFh"}],G9z0Bl:[function(e,n){function t(){var e=d.info=NREUM.info,n=f.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&n){c(p,function(n,t){n in e||(e[n]=t)});var t="https"===s.split(":")[0]||e.sslForHttp;d.proto=t?"https://":"http://",a("mark",["onload",i()]);var r=f.createElement("script");r.src=d.proto+e.agent,n.parentNode.insertBefore(r,n)}}function r(){"complete"===f.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=e("handle"),c=e(1),u=(e(2),window),f=u.document,s=(""+location).split("?")[0],p={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-632.min.js"},d=n.exports={offset:i(),origin:s,features:{}};f.addEventListener?(f.addEventListener("DOMContentLoaded",o,!1),u.addEventListener("load",t,!1)):(f.attachEvent("onreadystatechange",r),u.attachEvent("onload",t)),a("mark",["firstbyte",i()])},{1:12,2:3,handle:"D5DuLP"}],loader:[function(e,n){n.exports=e("G9z0Bl")},{}],12:[function(e,n){function t(e,n){var t=[],o="",i=0;for(o in e)r.call(e,o)&&(t[i]=n(o,e[o]),i+=1);return t}var r=Object.prototype.hasOwnProperty;n.exports=t},{}],13:[function(e,n){function t(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(0>o?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=t},{}]},{},["G9z0Bl"]);</script>
<meta content="width=device-width,initial-scale=1" name="viewport">
<meta content="NOODP" name="robots">
<meta content="Articles by thoughtbot about design, Ruby on Rails, iOS, and growth." name="description">
<link href="https://twitter.com/brittballard" rel="author">

<meta content="summary" name="twitter:card">
<meta content="@thoughtbot" name="twitter:site">
<meta content="https://robots.thoughtbot.com/back-to-basics-polymorphism-and-ruby" name="twitter:url">
<meta content="Back to Basics: Polymorphism and Ruby" name="twitter:title">
<meta content="
Polymorphism
- the provision of a single interface to entities of different..." name="twitter:description">

<link rel="shortcut icon" type="image/x-icon" href="https://robots.thoughtbot.com/assets/favicon-b99b344b0c2d9291198ffa32d703b727.ico">
<link rel="apple-touch-icon" type="image/x-icon" href="https://robots.thoughtbot.com/assets/apple-touch-icon-cfdba6b977607115a47e7a3d861d65d5.png">
<title>Back to Basics: Polymorphism and Ruby</title>
<link rel="stylesheet" media="all" href="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/application-6a6699c29905f1e424f4412adf049170.css">
<link href="feed://feeds.feedburner.com/GiantRobotsSmashingIntoOtherGiantRobots" rel="alternate" type="application/rss+xml">
<script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/loq1vxq.js"></script>
<style type="text/css">.tk-calluna-sans{font-family:"calluna-sans",sans-serif;}.tk-freight-text-pro{font-family:"freight-text-pro",sans-serif;}.tk-courier-prime{font-family:"courier-prime",monospace;}</style><link media="all" href="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/d.css" rel="stylesheet"><script>try{Typekit.load();}catch(e){}</script>

</head>
<body>
<nav class="main">
<a class="logo" href="https://robots.thoughtbot.com/"></a>
</nav>


<section class="container">
<section id="posts">
<article class="post text" data-url="/back-to-basics-polymorphism-and-ruby">
<h1 class="title">Возвращаясь к основам: Полиморфизм и Ruby</h1>
<div class="meta">
<div class="meta-author">
<a href="https://twitter.com/brittballard">Britt Ballard</a>
</div>
<time class="meta-date" datetime="2014-03-14T00:00:00+00:00">
March 14, 2014
</time>
<ul class="meta-tag-list">
<li class="meta-tag-item">
<a href="https://robots.thoughtbot.com/tags/ruby">ruby</a>
</li>
<li class="meta-tag-item">
<a href="https://robots.thoughtbot.com/tags/back-to-basics">back to basics</a>
</li>
</ul>

</div>

<ul class="share-post-list">
<li class="share-network-item">
<a class="social-share-network social-twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" href="https://twitter.com/share?text=Back%20to%20Basics:%20Polymorphism%20and%20Ruby&amp;url=https://robots.thoughtbot.com/back-to-basics-polymorphism-and-ruby"><img alt="Twitter" src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/twitter-6e8a52837e98248a488f4305ca6b32ea.svg" height="15" width="15">
</a></li>
<li class="share-network-item">
<a class="social-share-network social-email" href="mailto:?body=Back%20to%20Basics%3A%20Polymorphism%20and%20Ruby%20-%20https%3A%2F%2Frobots.thoughtbot.com%2F%2Fback-to-basics-polymorphism-and-ruby&amp;subject=Check%20out%20this%20blog%20post%20by%20thoughtbot"><img alt="Email" src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/email-d7a128333d062fdf3a21b1ea023fb20b.svg" height="10" width="16">
</a></li>
</ul>

<div style="position: relative;" class="post-body"><div class="carnival"></div>
<blockquote>
<p><a href="http://www.stroustrup.com/glossary.html#Gpolymorphism">Полиморфизм</a>
- предоставление единого интерфейса к сущностям различного типа</p>
</blockquote>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="PioLla" id="PioLla-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="PioLla">Полиморфизм - одно из фундаментальных свойств объектно ориентированного программирования,
но что на самом деле оно означает? По сути, в Ruby, это означает возможность отправить
одно и то же сообщение различным объектам и получить различные результаты. Давайте рассмотрим
несколько разлчных способов достичь этого.</p>

<h2 id="inheritance">Наследование</h2>

<div class="carnival-comment-indicator" data-indicator-for="OwwLut" id="OwwLut-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="OwwLut">Одним из способов добиться полиморфизма является наследование. Давайте используем
<a href="https://ru.wikipedia.org/wiki/%D0%A8%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD%D0%BD%D1%8B%D0%B9_%D0%BC%D0%B5%D1%82%D0%BE%D0%B4_%28%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%29">Шаблонный метод</a> для создания простого файлового парсера.</p>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="FlcSia" id="FlcSia-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="FlcSia">Для начала давайте создадим класс <code>GenericParser</code>, содержащий метод <code>parse</code>. Учитывая что это шаблон, единственная вещь, которую этот метод будет делать - вызывать исключение:</p>

<div class="carnival-comment-indicator" data-indicator-for="cGdcGd" id="cGdcGd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cGdcGd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">GenericParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    raise <span class="constant">NotImplementedError</span>, <span class="string">'You must implement the parse method'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="NwnNwn" id="NwnNwn-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NwnNwn">Теперь нам необходимо сделать класс <code>JsonParser</code>, который that наследуется от <code>GenericParser</code>:</p>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="cJGcJG" id="cJGcJG-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cJGcJG"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">JsonParser</span> <span class="inheritance">&lt; <span class="parent">GenericParser</span></span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the JsonParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="LcaLca" id="LcaLca-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="LcaLca">Давайте также создадим <code>XmlParser</code> и также отнаследуем его от <code>GenericParser</code>:</p>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="cXGcXG" id="cXGcXG-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cXGcXG"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">XmlParser</span> <span class="inheritance">&lt; <span class="parent">GenericParser</span></span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the XmlParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="NlrNlr" id="NlrNlr-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NlrNlr">Теперь давайте запустим скрипт и глянем как он себя ведет:</p>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="pUtpUt" id="pUtpUt-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="pUtpUt"><code class="ruby hljs">puts <span class="string">'Using the XmlParser'</span>
parser = <span class="constant">XmlParser</span>.new
parser.parse

puts <span class="string">'Using the JsonParser'</span>
parser = <span class="constant">JsonParser</span>.new
parser.parse
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="TroTro" id="TroTro-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="TroTro">В результате работы на экран будет выведено:</p>

<div class="carnival-comment-indicator" data-indicator-for="UtXUtX" id="UtXUtX-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="UtXUtX"><code class="hljs">Using the XmlParser
An instance of the XmlParser class received the parse message

Using the JsonParser
An instance of the JsonParser class received the parse message
</code></pre>

<div style="opacity: 0;" class="carnival-comment-indicator" data-indicator-for="NhtBtX" id="NhtBtX-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NhtBtX">Обратите внимание как по-разному ведет себя код, в зависимости от того, какой у какого дочернего класса был вызван метод <code>parse</code>. И <abbr title="Extensible Markup Language">XML</abbr>
и <abbr title="JavaScript Object Notation">JSON</abbr> парсеры изменили поведение
<code>GenericParser</code>, который вызывает исключение.</p>

<h2 id="duck-typing">Утиная типизация</h2>

<div class="carnival-comment-indicator" data-indicator-for="IstIst" id="IstIst-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="IstIst">В статически типизированных языках, runtime-полиморфизма добиться более сложно.
К счастью, с Ruby мы можем использовать <a href="https://ru.wikipedia.org/wiki/%D0%A3%D1%82%D0%B8%D0%BD%D0%B0%D1%8F_%D1%82%D0%B8%D0%BF%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F">Утиную типизацию</a>.</p>

<div class="carnival-comment-indicator" data-indicator-for="WuoWuo" id="WuoWuo-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WuoWuo">Мы вновь используем наши <abbr title="Extensible Markup Language">XML</abbr> и <abbr title="JavaScript Object Notation">JSON</abbr> парсеры для этого примера,
за исключением наследования:</p>

<div class="carnival-comment-indicator" data-indicator-for="cXdcXd" id="cXdcXd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cXdcXd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">XmlParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the XmlParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="class"><span class="keyword">class</span> <span class="title">JsonParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the JsonParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="NwbNwb" id="NwbNwb-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NwbNwb">Теперь мы создадим generic parser, который отправляет сообщение <code>parse</code> парсеру, которое тот получает в качестве аргумента:</p>

<div class="carnival-comment-indicator" data-indicator-for="cGdcGd" id="cGdcGd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cGdcGd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">GenericParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse(parser)
    parser.parse
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="NwhTot" id="NwhTot-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NwhTot">Теперь у нас есть неплохой рабочий пример утиной (неявной) типизации. Обратите внимание на то, как метод <code>parse</code>
принимает переменную <code>parser</code>. Единственная вещь, необходимая для того, чтобы это заработало, это чтобы объект <code>parser</code> отвечал на сообщение <code>parse</code> и, к счастью, оба наши парсера это умеют!</p>

<div class="carnival-comment-indicator" data-indicator-for="LptLpt" id="LptLpt-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="LptLpt">Давайте соберем вместе наш скрипт и посмотрим его в действии:</p>

<div class="carnival-comment-indicator" data-indicator-for="pGUpGU" id="pGUpGU-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="pGUpGU"><code class="ruby hljs">parser = <span class="constant">GenericParser</span>.new
puts <span class="string">'Using the XmlParser'</span>
parser.parse(<span class="constant">XmlParser</span>.new)

puts <span class="string">'Using the JsonParser'</span>
parser.parse(<span class="constant">JsonParser</span>.new)
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="TswTsw" id="TswTsw-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="TswTsw">В результате работы этого скрипта мы получим следующий вывод:</p>

<div class="carnival-comment-indicator" data-indicator-for="UtXUtX" id="UtXUtX-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="UtXUtX"><code class="hljs">Using the XmlParser
An instance of the XmlParser class received the parse message

Using the JsonParser
An instance of the JsonParser class received the parse message
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="NttTip" id="NttTip-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NttTip">Обратите внимание что метод ведет себя по-разному, в зависимости от того, какой объект получает его сообщение. Это и есть полиморфизм!</p>

<h2 id="decorator-pattern">Паттерн "Декоратор"</h2>

<div class="carnival-comment-indicator" data-indicator-for="WcaLla" id="WcaLla-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WcaLla">Мы также можем получить полиморфизм используя паттерны проектирования. Давайте глянем на пример с использованием паттерна <a href="https://ru.wikipedia.org/wiki/%D0%94%D0%B5%D0%BA%D0%BE%D1%80%D0%B0%D1%82%D0%BE%D1%80_%28%D1%88%D0%B0%D0%B1%D0%BB%D0%BE%D0%BD_%D0%BF%D1%80%D0%BE%D0%B5%D0%BA%D1%82%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F%29">декоратор</a>:</p>

<div class="carnival-comment-indicator" data-indicator-for="cPdcPd" id="cPdcPd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cPdcPd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">Parser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'The Parser class received the parse method'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="WntTpm" id="WntTpm-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WntTpm">Нам необходимо внести изменения в код нашего <code>XmlParser</code> добавив конструктор, принимающий парсер как аргумент. Метод <code>parse</code> необходимо модифицировать так, чтобы он отправлял сообщение <code>parse</code> объекту парсера, который он получает в момент инициализации:</p>

<div class="carnival-comment-indicator" data-indicator-for="cXdcXd" id="cXdcXd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cXdcXd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">XmlParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>initialize(parser)
    <span class="variable">@parser</span> = parser
  <span class="keyword">end</span>

  <span class="function"><span class="keyword">def</span> </span>parse
    <span class="variable">@parser</span>.parse
    puts <span class="string">'An instance of the XmlParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="WmtWmt" id="WmtWmt-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WmtWmt">Аналогичные изменения мы должны сделать и в нашем <code>JsonParser</code>:</p>

<div class="carnival-comment-indicator" data-indicator-for="cJdcJd" id="cJdcJd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cJdcJd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">JsonParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>initialize(parser)
    <span class="variable">@parser</span> = parser
  <span class="keyword">end</span>

  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the JsonParser class received the parse message'</span>
    <span class="variable">@parser</span>.parse
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="WutWut" id="WutWut-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WutWut">Мы использовали декораторы для создания наших обычных <abbr title="Extensible Markup
Language">XML</abbr> и <abbr title="JavaScript Object Notation">JSON</abbr>
парсеров, но в последнем примере мы сделаем кое-что иное: используем оба декоратора для достижения runtime полиморфизма:</p>

<div class="carnival-comment-indicator" data-indicator-for="pUtpUt" id="pUtpUt-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="pUtpUt"><code class="ruby hljs">puts <span class="string">'Using the XmlParser'</span>
parser = <span class="constant">Parser</span>.new
<span class="constant">XmlParser</span>.new(parser).parse

puts <span class="string">'Using the JsonParser'</span>
<span class="constant">JsonParser</span>.new(parser).parse

puts <span class="string">'Using both Parsers!'</span>
<span class="constant">JsonParser</span>.new(<span class="constant">XmlParser</span>.new(parser)).parse
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="TswTsw" id="TswTsw-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="TswTsw">Этот скрипт выдаст следующее:</p>

<div class="carnival-comment-indicator" data-indicator-for="UtXUtX" id="UtXUtX-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="UtXUtX"><code class="hljs">Using the XmlParser
The Parser class received the parse method
An instance of the XmlParser class received the parse message

Using the JsonParser
An instance of the JsonParser class received the parse message
The Parser class received the parse method

Using both Parsers!
An instance of the JsonParser class received the parse message
The Parser class received the parse method
An instance of the XmlParser class received the parse message
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="NhwNhw" id="NhwNhw-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NhwNhw">Глядя на вывод, заметьте как мы можем изменить результат отправки сообщения <code>parse</code>.</p>

<h2 id="a-simple-before-and-after">До и после...</h2>

<div class="carnival-comment-indicator" data-indicator-for="NwwLsw" id="NwwLsw-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="NwwLsw">Давайте теперь глянем на простой пример того, какие преимущества предоставляет полиморфизм для упрощения нашего кода. 
Предположим, у нас есть следующий класс:</p>

<div class="carnival-comment-indicator" data-indicator-for="cPdcPd" id="cPdcPd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cPdcPd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">Parser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse(type)
    puts <span class="string">'The Parser class received the parse method'</span>

    <span class="keyword">if</span> type == <span class="symbol">:xml</span>
      puts <span class="string">'An instance of the XmlParser class received the parse message'</span>
    <span class="keyword">elsif</span> type == <span class="symbol">:json</span>
      puts <span class="string">'An instance of the JsonParser class received the parse message'</span>
    <span class="keyword">end</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="WcsNwh" id="WcsNwh-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="WcsNwh">Мы можем упростить наш класс <code>Parser</code> удалив логику ветвления благодаря простой
"утиной" типизации. В этом конкретном примере мы также получим пользу от разделения
обязанностей. Таким образом мы получим нашу логику парсинга инкапсулированную своими собственными классами:</p>

<div class="carnival-comment-indicator" data-indicator-for="cPdcPd" id="cPdcPd-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><pre id="cPdcPd"><code class="ruby hljs"><span class="class"><span class="keyword">class</span> <span class="title">Parser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse(parser)
    puts <span class="string">'The Parser class received the parse method'</span>
    parser.parse
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="class"><span class="keyword">class</span> <span class="title">XmlParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the XmlParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>

<span class="class"><span class="keyword">class</span> <span class="title">JsonParser</span></span>
  <span class="function"><span class="keyword">def</span> </span>parse
    puts <span class="string">'An instance of the JsonParser class received the parse message'</span>
  <span class="keyword">end</span>
<span class="keyword">end</span>
</code></pre>

<div class="carnival-comment-indicator" data-indicator-for="TedWwa" id="TedWwa-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="TedWwa">Этот пример демонстрирует возможность упрощения наших классов используя
полиморфизм. Также, благодаря этому мы можем добиться соблюдения <a href="https://ru.wikipedia.org/wiki/%D0%9F%D1%80%D0%B8%D0%BD%D1%86%D0%B8%D0%BF_%D0%B5%D0%B4%D0%B8%D0%BD%D1%81%D1%82%D0%B2%D0%B5%D0%BD%D0%BD%D0%BE%D0%B9_%D0%BE%D0%B1%D1%8F%D0%B7%D0%B0%D0%BD%D0%BD%D0%BE%D1%81%D1%82%D0%B8">Принципа Единственной Обязанности</a>.</p>

<div class="carnival-comment-indicator" data-indicator-for="ItiItl" id="ItiItl-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="ItiItl">В первоначальной версии кода класс Parser определял какой парсер использовать
и затем запускал парсинг через создание экземпляров и отправку сообщения parse
объекту. В последней версии этот класс лишь отсылает метод parse
для того, чтобы запустить процесс.</p>

<div class="carnival-comment-indicator" data-indicator-for="PioTtt" id="PioTtt-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="PioTtt">Полиморфизм - один из фундаментальных элементов объектно ориентированного
программирования, но также он может быть весьма нетривиальным для понимания. Понимание его и осознание
почему он важен - это большой шаг на пути к написанию более
поддерживаемого и расширяемого кода.</p>

<h2 id="what's-next">What’s next</h2>

<div class="carnival-comment-indicator" data-indicator-for="IyfIyf" id="IyfIyf-indicator"><span class="carnival-count">+</span><svg><path d="M0.848275862,0 C0.38,0 0,0.508615385 0,1.13538462 L0,18.4006154 C0,19.0273846 0.38,19.536 0.848275862,19.536 L4.16896552,19.536 L4.16896552,22.8 C4.16896552,23.6815385 4.60068966,23.9704615 5.12758621,23.4433846 L9.03448276,19.5369231 L19.2206897,19.5369231 C19.6889655,19.5369231 20.0689655,19.0283077 20.0689655,18.4015385 L20.0689655,1.13538462 C20.0696552,0.508615385 19.6896552,3.68935651e-15 19.2213793,3.68935651e-15 L0.848275862,0 Z"></path></svg></div><p id="IyfIyf">If you found this useful, you might also enjoy:</p>

<ul>
<li><a href="http://robots.thoughtbot.com/using-polymorphism-to-make-a-better-activity-feed-in-rails">Using Polymorphism to Make a Better Activity Feed in Rails</a></li>
<li><a href="http://robots.thoughtbot.com/refactoring-replace-conditional-with-polymorphism">Refactoring: Replace Conditional with Polymorphism</a></li>
<li><a href="http://robots.thoughtbot.com/evaluating-alternative-decorator-implementations-in">Evaluating Alternative Decorator Implementations In Ruby</a></li>
</ul>

</div>
</article>
<div class="author-box">
<div class="author-box-avatar">
<img alt="author image" src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/britt.jpg">
</div>
<span class="author-box-name">
<a href="https://twitter.com/brittballard">Britt Ballard</a>
</span>

</div>
<div class="promoted">
</div>
<script>
  document.addEventListener("DOMContentLoaded", function() {
    Carnival.init({
      article_author: "Britt Ballard",
      article_selector: "article .post-body",
      onNewComment: function(comment) {
        [].slice.call(comment.element.querySelectorAll("pre code")).map(
          function(e) { hljs.highlightBlock(e); }
        );
      }
    });
  })
</script>

</section>
</section>
<section class="container etc">
<p>
Pair with one of our expert developers to level up your skills with
<a class="coaching" href="http://coaching.thoughtbot.com/?utm_source=thoughtbot&amp;utm_medium=blog&amp;utm_campaign=blog-footer-ads">Coaching by thoughtbot.</a>
Save time learning best practices and techniques for reducing technical debt
in Ember, Ruby, Haskell, and Go in 1-on-1 sessions tailored to your goals.
</p>



</section>
<footer>
<section id="universal-footer">
<div class="wrap">
<div class="footer-nav">
<ul>
<li class="title">
Services
</li>
<li>
<a href="https://thoughtbot.com/work">Consulting
</a></li>
<li>
<a href="http://coaching.thoughtbot.com/">Coaching
</a></li>
<li>
<a href="https://thoughtbot.com/workshops">Workshops
</a></li>
<li>
<a href="https://thoughtbot.com/hire-us">Hire Us
</a></li>
</ul>
<ul>
<li class="title">
Products
</li>
<li>
<a href="https://formkeep.com/">FormKeep
</a></li>
<li>
<a href="https://houndci.com/">Hound
</a></li>
<li>
<a href="http://playroto.to/">Rototo
</a></li>
<li>
<a href="http://troposweather.com/">Tropos
</a></li>
<li>
<a href="https://upcase.com/">Upcase
</a></li>
</ul>
<ul>
<li class="title">
Open Source
</li>
<li>
<a href="https://github.com/thoughtbot/Argo">Argo
</a></li>
<li>
<a href="http://bourbon.io/">Bourbon
</a></li>
<li>
<a href="https://github.com/thoughtbot/capybara-webkit">Capybara Webkit
</a></li>
<li>
<a href="https://github.com/thoughtbot/clearance">Clearance
</a></li>
<li>
<a href="https://github.com/thoughtbot/dotfiles">Dotfiles
</a></li>
<li>
<a href="https://github.com/thoughtbot/factory_girl">Factory Girl
</a></li>
<li>
<a href="https://github.com/thoughtbot/laptop">Laptop
</a></li>
<li>
<a href="https://github.com/thoughtbot/Runes">Runes
</a></li>
<li>
<a href="https://github.com/thoughtbot/suspenders">Suspenders
</a></li>
<li>
<a href="https://github.com/thoughtbot">More...
</a></li>
</ul>
<ul>
<li class="title">
Books
</li>
<li>
<a href="http://backbonejsonrails.com/">Backbone.js on Rails
</a></li>
<li>
<a href="http://designfortheweb.net/">Design for the Web
</a></li>
<li>
<a href="http://geocodingonrails.com/">Geocoding on Rails
</a></li>
<li>
<a href="http://goal-oriented-git.com/">Goal-Oriented Git
</a></li>
<li>
<a href="http://iosonrails.net/">iOS on Rails
</a></li>
<li>
<a href="http://maintaining-open-source.com/">Maintaining OSS
</a></li>
<li>
<a href="http://playbook.thoughtbot.com/">Playbook
</a></li>
<li>
<a href="http://rubyscience.com/">Ruby Science
</a></li>
<li>
<a href="http://testingrailsbook.com/">Testing Rails
</a></li>
<li>
<a href="http://write-a-roguelike.com/">Write a Roguelike
</a></li>
</ul>
<ul>
<li class="title">
Podcasts
</li>
<li>
<a href="http://bikeshed.fm/">The Bike Shed
</a></li>
<li>
<a href="http://buildphase.fm/">Build Phase
</a></li>
<li>
<a href="http://giantrobots.fm/">Giant Robots
</a></li>
<li>
<a href="http://rebootshow.fm/">Reboot
</a></li>
<li>
<a href="http://tentative.fm/">Tentative
</a></li>
</ul>
</div>
</div>
</section>
</footer>
<div id="copyright-footer">
<strong>© 2015 thoughtbot, inc.</strong>
The design of a robot and thoughtbot are registered trademarks of
thoughtbot, inc.
</div>

<script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/application-d03d97b5a4153583fc3e945defbb9cba.js"></script>
<script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/init.js"></script>

<script>
  window.analytics.load("wperrhev8f")
  window.analytics.page();
</script>



<div><link rel="stylesheet" href="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/autogen-4OcIrL-k.css">
<script src="Back%20to%20Basics:%20Polymorphism%20and%20Ruby_files/autogen-E-aJoBrR.js"></script></div></body></html>